<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="generator" content="HTML Tidy for Linux (vers 7 December 2008), see www.w3.org"/>
<meta http-equiv="CONTENT-TYPE" content="text/html; charset=utf-8"/>

<meta name="GENERATOR" content="OpenOffice.org 3.0 (Unix)"/>
<meta name="CREATED" content="20151109;11564100"/>
<meta name="CHANGED" content="20151129;1342700"/>
<meta name="Info_1" content=""/>
<meta name="Info_2" content=""/>
<meta name="Info_3" content=""/>
<meta name="Info_4" content=""/>
<title>Essential Python</title>
<meta content="http://www.w3.org/1999/xhtml; charset=utf-8" http-equiv="Content-Type"/><link href="stylesheet.css" type="text/css" rel="stylesheet"/><style type="text/css">
		@page { margin-bottom: 5.000000pt; margin-top: 5.000000pt; }</style></head>
<body dir="ltr" class="calibre">
<h1 lang="en-GB" class="western3" id="calibre_pb_19"><a id="Configuration_Files"></a> 21. Configuration Files</h1>
<p lang="en-GB" class="western">A configuration file is a text
file that allows the configuration of a program to be saved, they
usually have the file extension .ini. The Python
<b class="calibre2">configparser</b> class makes using these files very simple. An
example of a configuration file is shown below.</p>
<p lang="en-GB" class="c5"><span class="c6">[DEFAULT]</span></p>
<p lang="en-GB" class="c5"><span class="c6">text =
Black</span></p>
<p lang="en-GB" class="c5"><span class="c6">toolbar =
Grey</span></p>
<p lang="en-GB" class="c5"><span class="c6">background =
White</span></p>
<p lang="en-GB" class="c7"> <br class="calibre1"/></p>
<p lang="en-GB" class="c5"><span class="c6">[logging]</span></p>
<p lang="en-GB" class="c5"><span class="c6">enabled =
True</span></p>
<p lang="en-GB" class="c5"><span class="c6">eventstostore =
10</span></p>
<p lang="en-GB" class="c7"> <br class="calibre1"/></p>
<p lang="en-GB" class="c5"><span class="c6">[serialport]</span></p>
<p lang="en-GB" class="c5"><span class="c6">port = COM1</span></p>
<p lang="en-GB" class="c5"><span class="c6">baud =
115200</span></p>
<p lang="en-GB" class="c5"><span class="c6">parity =
none</span></p>
<p lang="en-GB" class="western">The file example contains three
sections the sections allow the grouping of similar configuration
items. The first section is the default section the values stored
in here get added to the other two sections. The next section is
logging which has two configuration items and finally serial port
which has three items. The script below will create the example
configuration file shown above.</p>
<p lang="en-GB" class="c5"><span class="c6"># File:
configFileWrite.py</span></p>
<p lang="en-GB" class="c5"><span class="c6">import
configparser</span></p>
<p lang="en-GB" class="c7"> <br class="calibre1"/></p>
<p lang="en-GB" class="c5"><span class="c6">config =
configparser.ConfigParser()</span></p>
<p lang="en-GB" class="c5"><span class="c6"># add some default
parameters</span></p>
<p lang="en-GB" class="c5"><span class="c6">config['DEFAULT'] =
{'Background': 'White',</span></p>
<p lang="en-GB" class="c5"><span class="c6">'Text':
'Black',</span></p>
<p lang="en-GB" class="c5"><span class="c6">'ToolBar':
'Grey'}</span></p>
<p lang="en-GB" class="c5"><span class="c6"># create logging
section</span></p>
<p lang="en-GB" class="c5"><span class="c6">config['logging'] =
{}</span></p>
<p lang="en-GB" class="c5"><span class="c6">config['logging']['enabled'] = 'True'</span></p>
<p lang="en-GB" class="c5"><span class="c6">config['logging']['eventstostore'] = '10'</span></p>
<p lang="en-GB" class="c7"> <br class="calibre1"/></p>
<p lang="en-GB" class="c5"><span class="c6"># create serial port
section</span></p>
<p lang="en-GB" class="c5"><span class="c6">config['serialport'] =
{}</span></p>
<p lang="en-GB" class="c5"><span class="c6">port =
config['serialport']</span></p>
<p lang="en-GB" class="c5"><span class="c6">port['port'] =
'COM1'</span></p>
<p lang="en-GB" class="c5"><span class="c6">port['baud'] =
'115200'</span></p>
<p lang="en-GB" class="c5"><span class="c6">port['parity'] =
'none'</span></p>
<p lang="en-GB" class="c7"> <br class="calibre1"/></p>
<p lang="en-GB" class="c5"><span class="c6"># write the
file</span></p>
<p lang="en-GB" class="c5"><span class="c6">with
open('example.ini', 'w') as configfile:</span></p>
<p lang="en-GB" class="c5"><span class="c6">config.write(configfile)</span></p>
<p lang="en-GB" class="western">The script starts off by
creating an instance of the <b class="calibre2">ConfigParser</b>. It then uses a
dictionary to set the default values. The <b class="calibre2">configuration</b>
section is then created by creating an empty dictionary and adding
keys with their associated values, the <b class="calibre2">serialport</b> section is
then created in the same way. Finally the configuration file is
written, note that the configuration file parser only handles
strings as default.</p>
<p lang="en-GB" class="western">The following example shows the
example configuration file being read and the contents
displayed.</p>
<p lang="en-GB" class="c5"><span class="c6"># File:
configFileRead.py</span></p>
<p lang="en-GB" class="c5"><span class="c6">import
configparser</span></p>
<p lang="en-GB" class="c7"> <br class="calibre1"/></p>
<p lang="en-GB" class="c5"><span class="c6">config =
configparser.ConfigParser()</span></p>
<p lang="en-GB" class="c7"> <br class="calibre1"/></p>
<p lang="en-GB" class="c5"><span class="c6"># read the config
file</span></p>
<p lang="en-GB" class="c5"><span class="c6">config.read('example.ini')</span></p>
<p lang="en-GB" class="c7"> <br class="calibre1"/></p>
<p lang="en-GB" class="c5"><span class="c6"># print the sections
of the config file</span></p>
<p lang="en-GB" class="c5"><span class="c6">print(config.sections())</span></p>
<p lang="en-GB" class="c7"> <br class="calibre1"/></p>
<p lang="en-GB" class="c5"><span class="c6"># Check if logging is
in config</span></p>
<p lang="en-GB" class="c5"><span class="c6">print('logging is in
config: ', 'logging' in config)</span></p>
<p lang="en-GB" class="c7"> <br class="calibre1"/></p>
<p lang="en-GB" class="c5"><span class="c6"># Check if serial is
in config</span></p>
<p lang="en-GB" class="c5"><span class="c6">print('serialport is
in config: ', 'serialport' in config)</span></p>
<p lang="en-GB" class="c7"> <br class="calibre1"/></p>
<p lang="en-GB" class="c5"><span class="c6">print('Logging:',
config['logging']['enabled'])</span></p>
<p lang="en-GB" class="c5"><span class="c6">print('Parity: ',
config['serialport']['parity'])</span></p>
<p lang="en-GB" class="c5"><span class="c6">comport =
config['serialport']</span></p>
<p lang="en-GB" class="c5"><span class="c6">print('Serial Port: ',
comport['port'])</span></p>
<p lang="en-GB" class="c7"> <br class="calibre1"/></p>
<p lang="en-GB" class="c5"><span class="c6"># print all keys
relating to serial</span></p>
<p lang="en-GB" class="c5"><span class="c6">print('Serial
keys')</span></p>
<p lang="en-GB" class="c5"><span class="c6">for key in
config['serialport']:</span></p>
<p lang="en-GB" class="c5"><span class="c6">print(' ',
key)</span></p>
<p lang="en-GB" class="western">The example creates an instance
of the <b class="calibre2">ConfigParser</b> and then reads the configuration file,
it then displays the sections within the file, note that the
default section is not displayed as its values are contained in the
other two sections. The script checks that the logging and
serialport sections exist in the configuration file. This should be
done in a real application to prevent errors when reading the
values or to provide default values if a section does not exist.
The code then displays some of the values read from the file. The
final <b class="calibre2">for</b> loop displays all the keys in the serialport
section. If you look at the output from the program you will notice
that all the keys in the default section are displayed as well as
the keys in serialport.</p>
<p lang="en-GB" class="western"><br class="calibre1"/>
<br class="calibre1"/></p>
<p lang="en-GB" class="western"><br class="calibre1"/>
<br class="calibre1"/></p>
<p lang="en-GB" class="western"><br class="calibre1"/>
<br class="calibre1"/></p>
<p lang="en-GB" class="western"><br class="calibre1"/>
<br class="calibre1"/></p>
</body>
</html>

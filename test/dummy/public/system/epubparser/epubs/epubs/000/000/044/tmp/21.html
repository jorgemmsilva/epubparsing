<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="generator" content="HTML Tidy for Linux (vers 7 December 2008), see www.w3.org"/>
<meta http-equiv="CONTENT-TYPE" content="text/html; charset=utf-8"/>

<meta name="GENERATOR" content="OpenOffice.org 3.0 (Unix)"/>
<meta name="CREATED" content="20151109;11564100"/>
<meta name="CHANGED" content="20151129;1342700"/>
<meta name="Info_1" content=""/>
<meta name="Info_2" content=""/>
<meta name="Info_3" content=""/>
<meta name="Info_4" content=""/>
<title>Essential Python</title>
<meta content="http://www.w3.org/1999/xhtml; charset=utf-8" http-equiv="Content-Type"/><link href="stylesheet.css" type="text/css" rel="stylesheet"/><style type="text/css">
		@page { margin-bottom: 5.000000pt; margin-top: 5.000000pt; }</style></head>
<body dir="ltr" class="calibre">
<h1 lang="en-GB" class="western3" id="calibre_pb_18"><a id="Command_Line_Arguments"></a> 20. Command Line Arguments</h1>
<p lang="en-GB" class="western">Command line arguments can be
appended to the Python script name when a script is run from a
command window or via a batch file, a common use of this is where
the script has to load a file, the file name can be passed via the
command line.</p>
<p lang="en-GB" class="c5"><span class="c6">python displayfile.py
-f myFile.txt</span></p>
<p lang="en-GB" class="western">In the example above the Python
script <b class="calibre2">displayfile.py</b> has one option letter -f followed by
the value which in this case is myFile.txt.</p>
<p lang="en-GB" class="western">The command line arguments can
be accessed using <b class="calibre2">sys.argv</b> variable.</p>
<p lang="en-GB" class="c5"><span class="c6"># file:
cmdArgs1.py</span></p>
<p lang="en-GB" class="c5"><span class="c6">import sys</span></p>
<p lang="en-GB" class="c7"> <br class="calibre1"/></p>
<p lang="en-GB" class="c5"><span class="c6">print("Number
Arguments:", len(sys.argv))</span></p>
<p lang="en-GB" class="c5"><span class="c6">print("Arguments:",
str(sys.argv))</span></p>
<p lang="en-GB" class="western">If you run the above example
from the command line with following.</p>
<p lang="en-GB" class="c5"><span class="c6">python cmdArgs1.py -f
myFile.txt</span></p>
<p lang="en-GB" class="western">The output should show 3
arguments which are the filename, the argument type and the
argument value.</p>
<p lang="en-GB" class="western">These strings can fairly easily
be parsed but to make life easier Python has a couple of built in
ways of parsing the command line. The <b class="calibre2">getopt</b> method does
most of the work by parsing the command line, its syntax is as
follows.</p>
<p lang="en-GB" class="c5"><span class="c6">getopt.getopt(args,
options[, long_options])</span></p>
<p lang="en-GB" class="western">The arguments are the argument
string and the option letters. If an argument is required it is
followed by a colon. So in the example below the filename is
required but the separator is not required.</p>
<p lang="en-GB" class="c5"><span class="c6">myopts, args =
getopt.getopt(sys.argv[1:], "f:s", ["file=","separator =
"])</span></p>
<p lang="en-GB" class="western">The <b class="calibre2">long_options</b> are an
optional argument in this case the argument definition should be
followed by an equal sign.</p>
<p lang="en-GB" class="western">The method splits out the argv
list into a list of option, value pairs. If an unexpected option or
an option which requires an argument isn't included on the command
line then a <b class="calibre2">getopt.GetoptError</b> is raised, this exceptions
argument is a string detailing the error.</p>
<p lang="en-GB" class="c5"><span class="c6"># file:
cmdArgs2.py</span></p>
<p lang="en-GB" class="c5"><span class="c6">import sys</span></p>
<p lang="en-GB" class="c5"><span class="c6">import
getopt</span></p>
<p lang="en-GB" class="c7"> <br class="calibre1"/></p>
<p lang="en-GB" class="c5"><span class="c6">filename =
''</span></p>
<p lang="en-GB" class="c5"><span class="c6">separator =
''</span></p>
<p lang="en-GB" class="c7"> <br class="calibre1"/></p>
<p lang="en-GB" class="c5"><span class="c6">try:</span></p>
<p lang="en-GB" class="c5"><span class="c6"># parse the
input</span></p>
<p lang="en-GB" class="c5"><span class="c6"># -f is the filename
the : shows that this is required</span></p>
<p lang="en-GB" class="c5"><span class="c6"># -s seperator this is
not required so does not have a colon after it</span></p>
<p lang="en-GB" class="c5"><span class="c6">myopts, args =
getopt.getopt(sys.argv[1:], "f:s", ["file=", "separator =
"])</span></p>
<p lang="en-GB" class="c7"> <br class="calibre1"/></p>
<p lang="en-GB" class="c5"><span class="c6">except
getopt.GetoptError as e:</span></p>
<p lang="en-GB" class="c5"><span class="c6">print(str(e))</span></p>
<p lang="en-GB" class="c5"><span class="c6">print("Usage: %s -f
filename -s seperator" % sys.argv[0])</span></p>
<p lang="en-GB" class="c5"><span class="c6">sys.exit(2)</span></p>
<p lang="en-GB" class="c7"> <br class="calibre1"/></p>
<p lang="en-GB" class="c5"><span class="c6"># get the
values</span></p>
<p lang="en-GB" class="c5"><span class="c6">for opt, val in
myopts:</span></p>
<p lang="en-GB" class="c5"><span class="c6">if opt ==
'-f':</span></p>
<p lang="en-GB" class="c5"><span class="c6">filename =
val</span></p>
<p lang="en-GB" class="c5"><span class="c6">elif opt ==
'-s':</span></p>
<p lang="en-GB" class="c5"><span class="c6">separator =
val</span></p>
<p lang="en-GB" class="c7"> <br class="calibre1"/></p>
<p lang="en-GB" class="c5"><span class="c6"># print the
results</span></p>
<p lang="en-GB" class="c5"><span class="c6">print("File Name: ",
filename)</span></p>
<p lang="en-GB" class="c5"><span class="c6">print("Separator: ",
separator)</span></p>
<p lang="en-GB" class="western">In the above example
<b class="calibre2">getopt</b> is used to parse the file this is done within
<b class="calibre2">try-except</b> if an exception does occur then the details of
what arguments are required is displayed and the script exits.</p>
<p lang="en-GB" class="western">The final method that can be
used to parse the command line is to use <b class="calibre2">argparse</b>.</p>
<p lang="en-GB" class="c5"><span class="c6"># file:
cmdArgs3.py</span></p>
<p lang="en-GB" class="c5"><span class="c6">import
argparse</span></p>
<p lang="en-GB" class="c7"> <br class="calibre1"/></p>
<p lang="en-GB" class="c5"><span class="c6">myparser =
argparse.ArgumentParser(description="Script to print
file")</span></p>
<p lang="en-GB" class="c5"><span class="c6">myparser.add_argument('-f', '--filename', help='File Name',
required=True)</span></p>
<p lang="en-GB" class="c5"><span class="c6">myparser.add_argument('-s', '--separator', help='Separator',
required=False)</span></p>
<p lang="en-GB" class="c5"><span class="c6">args =
myparser.parse_args()</span></p>
<p lang="en-GB" class="c7"> <br class="calibre1"/></p>
<p lang="en-GB" class="c5"><span class="c6">print("File Name: ",
args.filename)</span></p>
<p lang="en-GB" class="c5"><span class="c6">print("Separator: ",
args.separator)</span></p>
<p lang="en-GB" class="western">The above shows a simple example
of the <b class="calibre2">argparse</b> in operation. A parser <b class="calibre2">myparser</b> is
created and then two arguments are added into the parser these are
the same arguments as in the <b class="calibre2">cmdArgs2.py</b> example. The short
and long versions of the option are the first two arguments, these
are followed by help text describing the option and the required
flag which defines if the argument is required.</p>
<p lang="en-GB" class="western">The <b class="calibre2">add_argument</b> method
has lots of other options the lines below show two of the more
useful options the first checks the option against a list of valid
values and the second converts the input into an integer.</p>
<p lang="en-GB" class="c5"><span class="c6">parser.add_argument('colour', choices=['red', 'green',
'blue'])</span></p>
<p lang="en-GB" class="c5"><span class="c6">parser.add_argument('count', type=int)</span></p>
<p lang="en-GB" class="western"><br class="calibre1"/>
<br class="calibre1"/></p>
<p lang="en-GB" class="western"><br class="calibre1"/>
<br class="calibre1"/></p>
<p lang="en-GB" class="western"><br class="calibre1"/>
<br class="calibre1"/></p>
<p lang="en-GB" class="western"><br class="calibre1"/>
<br class="calibre1"/></p>
</body>
</html>
